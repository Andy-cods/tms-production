[{"filePath":"C:\\Users\\Admin\\Desktop\\tms-fix\\tms-real-main\\components\\charts\\recharts-formatters.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Admin\\Desktop\\tms-fix\\tms-real-main\\components\\charts\\tooltip-card.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Admin\\Desktop\\tms-fix\\tms-real-main\\components\\dashboard\\activity-feed.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Admin\\Desktop\\tms-fix\\tms-real-main\\components\\dashboard\\aging-report.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":113,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":113,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3309,3312],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3309,3312],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport React from \"react\";\r\nimport {\r\n  BarChart,\r\n  Bar,\r\n  XAxis,\r\n  YAxis,\r\n  CartesianGrid,\r\n  Tooltip,\r\n  ResponsiveContainer,\r\n  Cell,\r\n  LabelList,\r\n} from \"recharts\";\r\nimport type { AgingData } from \"@/lib/services/time-analysis-service\";\r\nimport { TooltipCard } from \"@/components/charts/tooltip-card\";\r\nimport { formatPercent } from \"@/components/charts/recharts-formatters\";\r\n\r\ninterface Props {\r\n  data: AgingData[];\r\n  loading?: boolean;\r\n  onRangeClick?: (range: string) => void;\r\n}\r\n\r\ntype AgingTooltipItem = { payload: AgingData };\r\n\r\nfunction AgingTooltip({\r\n  active,\r\n  payload,\r\n}: {\r\n  active?: boolean;\r\n  payload?: AgingTooltipItem[];\r\n}) {\r\n  if (!active || !payload || payload.length === 0) return null;\r\n\r\n  const item = payload[0]?.payload;\r\n  if (!item) return null;\r\n\r\n  return (\r\n    <TooltipCard>\r\n      <p className=\"text-sm font-medium text-gray-900 mb-1\">{item.range}</p>\r\n      <p className=\"text-sm text-gray-700\">\r\n        S·ªë l∆∞·ª£ng: <span className=\"font-medium\">{item.count}</span>\r\n      </p>\r\n      <p className=\"text-xs text-gray-600\">T·ª∑ l·ªá: {item.percentage}%</p>\r\n    </TooltipCard>\r\n  );\r\n}\r\n\r\nfunction getAgeColor(range: string): string {\r\n  if (range.includes('>14') || range.includes('>30')) return '#ef4444'; // red - critical\r\n  if (range.includes('7-14')) return '#f59e0b'; // amber - warning\r\n  return '#10b981'; // green - ok\r\n}\r\n\r\nexport function AgingReport({ data, loading, onRangeClick }: Props) {\r\n  if (loading) {\r\n    return (\r\n      <div className=\"h-[400px] bg-gray-50 rounded animate-pulse\"></div>\r\n    );\r\n  }\r\n\r\n  if (data.length === 0) {\r\n    return (\r\n      <div className=\"h-[400px] flex items-center justify-center bg-gray-50 rounded\">\r\n        <div className=\"text-center\">\r\n          <p className=\"text-green-600 font-medium mb-1\">‚úÖ Kh√¥ng c√≥ y√™u c·∫ßu ƒëang ch·ªù</p>\r\n          <p className=\"text-sm text-gray-500\">T·∫•t c·∫£ y√™u c·∫ßu ƒë√£ ƒë∆∞·ª£c x·ª≠ l√Ω</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const totalActive = data.reduce((sum, item) => sum + item.count, 0);\r\n  const criticalCount = data.find(d => d.range.includes('>14'))?.count || 0;\r\n\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      {/* Summary header */}\r\n      <div className=\"flex items-center justify-between text-sm\">\r\n        <div>\r\n          <p className=\"text-gray-700\">\r\n            <span className=\"font-medium\">T·ªïng ƒëang ch·ªù:</span> {totalActive} y√™u c·∫ßu\r\n          </p>\r\n        </div>\r\n        {criticalCount > 0 && (\r\n          <div className=\"text-red-600 font-medium\">\r\n            ‚ö†Ô∏è {criticalCount} y√™u c·∫ßu {'>'}14 ng√†y\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Chart */}\r\n      <ResponsiveContainer width=\"100%\" height={350}>\r\n        <BarChart \r\n          data={data} \r\n          layout=\"vertical\"\r\n          margin={{ top: 10, right: 30, left: 80, bottom: 5 }}\r\n        >\r\n          <CartesianGrid strokeDasharray=\"3 3\" stroke=\"#e5e7eb\" />\r\n          <XAxis type=\"number\" tick={{ fontSize: 12 }} />\r\n          <YAxis \r\n            type=\"category\" \r\n            dataKey=\"range\" \r\n            tick={{ fontSize: 12 }}\r\n            width={75}\r\n          />\r\n          <Tooltip content={<AgingTooltip />} />\r\n          \r\n          <Bar \r\n            dataKey=\"count\" \r\n            radius={[0, 4, 4, 0]}\r\n            onClick={(data: any) => onRangeClick?.(data.range)}\r\n            cursor=\"pointer\"\r\n          >\r\n            <LabelList \r\n              dataKey=\"percentage\" \r\n              position=\"right\" \r\n              formatter={(value: unknown) => formatPercent(value, 0)}\r\n              style={{ fontSize: 11, fill: '#6b7280' }}\r\n            />\r\n            {data.map((entry, index) => (\r\n              <Cell key={`cell-${index}`} fill={getAgeColor(entry.range)} />\r\n            ))}\r\n          </Bar>\r\n        </BarChart>\r\n      </ResponsiveContainer>\r\n\r\n      {/* Footer note */}\r\n      {criticalCount > 0 && (\r\n        <div className=\"pt-3 border-t text-xs text-gray-600\">\r\n          üí° C√°c y√™u c·∫ßu {'>'}14 ng√†y c·∫ßn ƒë∆∞·ª£c xem x√©t v√† x·ª≠ l√Ω ∆∞u ti√™n\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Admin\\Desktop\\tms-fix\\tms-real-main\\components\\dashboard\\at-risk-alerts.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Admin\\Desktop\\tms-fix\\tms-real-main\\components\\dashboard\\bottleneck-alerts.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Admin\\Desktop\\tms-fix\\tms-real-main\\components\\dashboard\\category-analysis.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":91,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":91,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2630,2633],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2630,2633],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":95,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":95,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2746,2749],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2746,2749],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport React, { useState } from \"react\";\r\nimport {\r\n  PieChart,\r\n  Pie,\r\n  Cell,\r\n  ResponsiveContainer,\r\n  Tooltip,\r\n} from \"recharts\";\r\nimport type { CategoryData } from \"@/lib/types/dashboard\";\r\nimport { TooltipCard } from \"@/components/charts/tooltip-card\";\r\n\r\ninterface Props {\r\n  categories: CategoryData[];\r\n  loading?: boolean;\r\n  onCategoryClick?: (categoryId: string) => void;\r\n}\r\n\r\ntype CategoryTooltipItem = { payload: CategoryData };\r\n\r\nfunction CategoryTooltip({\r\n  active,\r\n  payload,\r\n}: {\r\n  active?: boolean;\r\n  payload?: CategoryTooltipItem[];\r\n}) {\r\n  if (!active || !payload || payload.length === 0) return null;\r\n\r\n  const item = payload[0]?.payload;\r\n  if (!item) return null;\r\n\r\n  return (\r\n    <TooltipCard>\r\n      <p className=\"text-sm font-medium text-gray-900 mb-1\">{item.categoryName}</p>\r\n      <p className=\"text-xs text-gray-700\">T·ªïng: {item.total}</p>\r\n      <p className=\"text-xs text-gray-700\">Ho√†n th√†nh: {item.completed}</p>\r\n      <p className=\"text-xs text-gray-600\">T·ª∑ l·ªá: {item.completionRate.toFixed(1)}%</p>\r\n    </TooltipCard>\r\n  );\r\n}\r\n\r\nexport function CategoryAnalysis({ categories, loading, onCategoryClick }: Props) {\r\n  const [sortKey, setSortKey] = useState<keyof CategoryData>('total');\r\n  const [sortDir, setSortDir] = useState<'asc' | 'desc'>('desc');\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"space-y-4\">\r\n        <div className=\"h-[300px] bg-gray-100 rounded animate-pulse\"></div>\r\n        <div className=\"h-[200px] bg-gray-100 rounded animate-pulse\"></div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (categories.length === 0) {\r\n    return (\r\n      <div className=\"h-[400px] flex items-center justify-center bg-gray-50 rounded\">\r\n        <p className=\"text-gray-600\">Kh√¥ng c√≥ d·ªØ li·ªáu ph√¢n lo·∫°i</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const handleSort = (key: keyof CategoryData) => {\r\n    if (sortKey === key) {\r\n      setSortDir(sortDir === 'asc' ? 'desc' : 'asc');\r\n    } else {\r\n      setSortKey(key);\r\n      setSortDir('desc');\r\n    }\r\n  };\r\n\r\n  const sortedCategories = [...categories].sort((a, b) => {\r\n    const aVal = a[sortKey];\r\n    const bVal = b[sortKey];\r\n    const mult = sortDir === 'asc' ? 1 : -1;\r\n    return (aVal > bVal ? 1 : -1) * mult;\r\n  });\r\n\r\n  const totalRequests = categories.reduce((sum, cat) => sum + cat.total, 0);\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Pie Chart */}\r\n      <div>\r\n        <h4 className=\"text-sm font-medium text-gray-700 mb-3\">Ph√¢n b·ªë theo ph√¢n lo·∫°i</h4>\r\n        <ResponsiveContainer width=\"100%\" height={300}>\r\n          <PieChart>\r\n            <Pie\r\n              data={categories as any}\r\n              cx=\"50%\"\r\n              cy=\"50%\"\r\n              labelLine={false}\r\n              label={(entry: any) => `${entry.categoryName}: ${((entry.total / totalRequests) * 100).toFixed(0)}%`}\r\n              outerRadius={100}\r\n              dataKey=\"total\"\r\n              paddingAngle={2}\r\n            >\r\n              {categories.map((entry, index) => (\r\n                <Cell key={`cell-${index}`} fill={entry.color} />\r\n              ))}\r\n            </Pie>\r\n            <Tooltip content={<CategoryTooltip />} />\r\n          </PieChart>\r\n        </ResponsiveContainer>        <div className=\"text-center text-sm text-gray-600 mt-2\">\r\n          T·ªïng: {totalRequests} y√™u c·∫ßu\r\n        </div>\r\n      </div>\r\n\r\n      {/* Stats Table */}\r\n      <div>\r\n        <h4 className=\"text-sm font-medium text-gray-700 mb-3\">Chi ti·∫øt th·ªëng k√™</h4>\r\n        <div className=\"overflow-x-auto\">\r\n          <table className=\"w-full text-sm\">\r\n            <thead className=\"bg-gray-50 border-b text-xs\">\r\n              <tr>\r\n                <th className=\"px-3 py-2 text-left cursor-pointer hover:bg-gray-100\" onClick={() => handleSort('categoryName')}>\r\n                  Ph√¢n lo·∫°i\r\n                </th>\r\n                <th className=\"px-3 py-2 text-right cursor-pointer hover:bg-gray-100\" onClick={() => handleSort('total')}>\r\n                  T·ªïng\r\n                </th>\r\n                <th className=\"px-3 py-2 text-left cursor-pointer hover:bg-gray-100\" onClick={() => handleSort('completionRate')}>\r\n                  Ho√†n th√†nh\r\n                </th>\r\n                <th className=\"px-3 py-2 text-right cursor-pointer hover:bg-gray-100\" onClick={() => handleSort('avgLeadTime')}>\r\n                  Th·ªùi gian TB\r\n                </th>\r\n                <th className=\"px-3 py-2 text-right cursor-pointer hover:bg-gray-100\" onClick={() => handleSort('active')}>\r\n                  ƒêang x·ª≠ l√Ω\r\n                </th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {sortedCategories.map((cat) => (\r\n                <tr \r\n                  key={cat.categoryId}\r\n                  className=\"border-b hover:bg-gray-50 cursor-pointer transition-colors\"\r\n                  onClick={() => onCategoryClick?.(cat.categoryId)}\r\n                >\r\n                  <td className=\"px-3 py-2\">\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <div \r\n                        className=\"w-3 h-3 rounded-full flex-shrink-0\"\r\n                        style={{ backgroundColor: cat.color }}\r\n                      />\r\n                      <span className=\"font-medium text-gray-900\">{cat.categoryName}</span>\r\n                    </div>\r\n                  </td>\r\n                  <td className=\"px-3 py-2 text-right text-gray-700\">\r\n                    {cat.total}\r\n                  </td>\r\n                  <td className=\"px-3 py-2\">\r\n                    <div className=\"space-y-1\">\r\n                      <div className=\"w-full bg-gray-200 rounded-full h-2\">\r\n                        <div \r\n                          className=\"bg-green-500 h-2 rounded-full\"\r\n                          style={{ width: `${cat.completionRate}%` }}\r\n                        />\r\n                      </div>\r\n                      <span className=\"text-xs text-gray-600\">\r\n                        {cat.completionRate.toFixed(0)}% ({cat.completed}/{cat.total})\r\n                      </span>\r\n                    </div>\r\n                  </td>\r\n                  <td className=\"px-3 py-2 text-right text-gray-700\">\r\n                    {cat.avgLeadTime.toFixed(1)} ng√†y\r\n                  </td>\r\n                  <td className=\"px-3 py-2 text-right\">\r\n                    <span className={`font-medium ${cat.active > 5 ? 'text-red-600' : 'text-gray-700'}`}>\r\n                      {cat.active}\r\n                    </span>\r\n                  </td>\r\n                </tr>\r\n              ))}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Admin\\Desktop\\tms-fix\\tms-real-main\\components\\dashboard\\completion-rate-chart.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Admin\\Desktop\\tms-fix\\tms-real-main\\components\\dashboard\\cumulative-flow-diagram.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Admin\\Desktop\\tms-fix\\tms-real-main\\components\\dashboard\\cycle-time-trend.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Admin\\Desktop\\tms-fix\\tms-real-main\\components\\dashboard\\dashboard-filters.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":34,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":34,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1073,1076],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1073,1076],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport React, { useState, useTransition } from \"react\";\r\nimport { useRouter, usePathname, useSearchParams } from \"next/navigation\";\r\nimport { RefreshCw } from \"lucide-react\";\r\nimport type { DashboardFilters } from \"@/types/dashboard\";\r\n\r\nconst PERIOD_OPTIONS = [\r\n  { value: 'week', label: 'Tu·∫ßn n√†y' },\r\n  { value: 'month', label: 'Th√°ng n√†y' },\r\n  { value: 'quarter', label: 'Qu√Ω n√†y' },\r\n  { value: 'year', label: 'NƒÉm n√†y' },\r\n] as const;\r\n\r\ninterface Props {\r\n  onFilterChange?: (filters: DashboardFilters) => void;\r\n  initialFilters?: Partial<DashboardFilters>;\r\n  teams?: Array<{ id: string; name: string }>;\r\n  currentUserRole?: string;\r\n}\r\n\r\nexport function DashboardFiltersComponent({ \r\n  onFilterChange, \r\n  initialFilters, \r\n  teams = [],\r\n  currentUserRole \r\n}: Props) {\r\n  const router = useRouter();\r\n  const pathname = usePathname();\r\n  const searchParams = useSearchParams();\r\n  const [isPending, startTransition] = useTransition();\r\n  \r\n  const [filters, setFilters] = useState<DashboardFilters>({\r\n    period: (initialFilters?.period as any) || 'month',\r\n    teamId: initialFilters?.teamId,\r\n  });\r\n\r\n  const [isRefreshing, setIsRefreshing] = useState(false);\r\n\r\n  function handlePeriodChange(period: 'week' | 'month' | 'quarter' | 'year') {\r\n    const newFilters = { ...filters, period };\r\n    setFilters(newFilters);\r\n    updateURL(newFilters);\r\n    onFilterChange?.(newFilters);\r\n  }\r\n\r\n  function handleTeamChange(teamId: string) {\r\n    const newFilters = { ...filters, teamId: teamId || undefined };\r\n    setFilters(newFilters);\r\n    updateURL(newFilters);\r\n    onFilterChange?.(newFilters);\r\n  }\r\n\r\n  function updateURL(newFilters: DashboardFilters) {\r\n    startTransition(() => {\r\n      const params = new URLSearchParams(searchParams);\r\n      params.set('period', newFilters.period);\r\n      if (newFilters.teamId) {\r\n        params.set('teamId', newFilters.teamId);\r\n      } else {\r\n        params.delete('teamId');\r\n      }\r\n      router.push(`${pathname}?${params.toString()}`);\r\n    });\r\n  }\r\n\r\n  async function handleRefresh() {\r\n    setIsRefreshing(true);\r\n    try {\r\n      // Force refresh by updating URL with cache buster\r\n      const params = new URLSearchParams(searchParams);\r\n      params.set('_refresh', Date.now().toString());\r\n      router.refresh();\r\n      await new Promise(resolve => setTimeout(resolve, 500)); // Visual feedback\r\n    } finally {\r\n      setIsRefreshing(false);\r\n    }\r\n  }\r\n\r\n  const showTeamFilter = currentUserRole === 'ADMIN' || currentUserRole === 'LEADER';\r\n\r\n  return (\r\n    <div className=\"bg-white rounded-lg border p-4\">\r\n      <div className=\"flex flex-wrap items-center gap-4\">\r\n        {/* Period Selector */}\r\n        <div className=\"flex items-center gap-2\">\r\n          <span className=\"text-sm font-medium text-gray-700\">Kho·∫£ng th·ªùi gian:</span>\r\n          <div className=\"flex gap-1\">\r\n            {PERIOD_OPTIONS.map((option) => (\r\n              <button\r\n                key={option.value}\r\n                onClick={() => handlePeriodChange(option.value)}\r\n                disabled={isPending}\r\n                className={`px-3 py-1.5 text-sm font-medium rounded-md transition-colors ${\r\n                  filters.period === option.value\r\n                    ? 'bg-blue-600 text-white'\r\n                    : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\r\n                } disabled:opacity-50`}\r\n              >\r\n                {option.label}\r\n              </button>\r\n            ))}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Team Selector */}\r\n        {showTeamFilter && teams.length > 0 && (\r\n          <div className=\"flex items-center gap-2\">\r\n            <span className=\"text-sm font-medium text-gray-700\">Nh√≥m:</span>\r\n            <select\r\n              value={filters.teamId || ''}\r\n              onChange={(e) => handleTeamChange(e.target.value)}\r\n              disabled={isPending}\r\n              className=\"px-3 py-1.5 text-sm border rounded-md bg-white disabled:opacity-50\"\r\n            >\r\n              <option value=\"\">T·∫•t c·∫£ nh√≥m</option>\r\n              {teams.map((team) => (\r\n                <option key={team.id} value={team.id}>\r\n                  {team.name}\r\n                </option>\r\n              ))}\r\n            </select>\r\n          </div>\r\n        )}\r\n\r\n        {/* Refresh Button */}\r\n        <button\r\n          onClick={handleRefresh}\r\n          disabled={isRefreshing}\r\n          className=\"ml-auto p-2 rounded-md hover:bg-gray-100 transition-colors disabled:opacity-50\"\r\n          title=\"L√†m m·ªõi d·ªØ li·ªáu\"\r\n          aria-label=\"L√†m m·ªõi d·ªØ li·ªáu\"\r\n        >\r\n          <RefreshCw className={`h-5 w-5 text-gray-600 ${isRefreshing ? 'animate-spin' : ''}`} />\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Admin\\Desktop\\tms-fix\\tms-real-main\\components\\dashboard\\dashboard-header.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Admin\\Desktop\\tms-fix\\tms-real-main\\components\\dashboard\\gantt-chart.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":26,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":26,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[778,781],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[778,781],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":62,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":62,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1924,1927],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1924,1927],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":67,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":67,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2081,2084],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2081,2084],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":72,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":72,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2280,2283],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2280,2283],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":84,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":84,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2666,2669],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2666,2669],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":99,"column":15,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":99,"endColumn":18,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3520,3523],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3520,3523],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":100,"column":12,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":100,"endColumn":15,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3537,3540],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3537,3540],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":7,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport React, { useEffect, useRef, useState } from \"react\";\r\nimport Gantt from \"frappe-gantt\";\r\nimport { format } from \"date-fns\";\r\nimport { vi } from \"date-fns/locale\";\r\nimport type { GanttTask } from \"@/lib/services/gantt-service\";\r\nimport { Button } from \"@/components/ui/button\";\r\n\r\ninterface GanttChartProps {\r\n  tasks: GanttTask[];\r\n  viewMode?: \"Quarter Day\" | \"Half Day\" | \"Day\" | \"Week\" | \"Month\";\r\n  onTaskClick?: (task: GanttTask) => void;\r\n  onDateChange?: (task: GanttTask, start: Date, end: Date) => void;\r\n  height?: number;\r\n}\r\n\r\nexport function GanttChart({\r\n  tasks,\r\n  viewMode = \"Day\",\r\n  onTaskClick,\r\n  onDateChange,\r\n  height = 500,\r\n}: GanttChartProps) {\r\n  const ganttRef = useRef<HTMLDivElement>(null);\r\n  const ganttInstance = useRef<any>(null);\r\n\r\n  useEffect(() => {\r\n    if (!ganttRef.current || tasks.length === 0) return;\r\n\r\n    // Destroy previous instance\r\n    if (ganttInstance.current) {\r\n      ganttInstance.current = null;\r\n    }\r\n\r\n    // Convert GanttTask to frappe-gantt format\r\n    const frappeGanttTasks = tasks.map((task) => {\r\n      const startDate = task.start instanceof Date ? task.start : new Date(task.start);\r\n      const endDate = task.end instanceof Date ? task.end : new Date(task.end);\r\n      \r\n      return {\r\n        id: task.id,\r\n        name: task.name,\r\n        start: format(startDate, \"yyyy-MM-dd\"),\r\n        end: format(endDate, \"yyyy-MM-dd\"),\r\n        progress: task.progress,\r\n        dependencies: task.dependencies.join(\", \"),\r\n        custom_class: task.custom_class || \"\",\r\n        // Store original task data for callbacks\r\n        _original: task,\r\n      };\r\n    });\r\n\r\n    try {\r\n      // Create new Gantt instance\r\n      ganttInstance.current = new Gantt(ganttRef.current, frappeGanttTasks, {\r\n        view_mode: viewMode,\r\n        date_format: \"DD/MM/YYYY\",\r\n        language: \"vi\",\r\n\r\n        // Callbacks\r\n        on_click: (task: any) => {\r\n          if (onTaskClick && task._original) {\r\n            onTaskClick(task._original);\r\n          }\r\n        },\r\n        on_date_change: (task: any, start: Date, end: Date) => {\r\n          if (onDateChange && task._original) {\r\n            onDateChange(task._original, start, end);\r\n          }\r\n        },\r\n        on_progress_change: (task: any, progress: number) => {\r\n          // Optional: handle progress drag\r\n          console.log(`Task ${task.name} progress: ${progress}%`);\r\n        },\r\n\r\n        // Styling\r\n        bar_height: 30,\r\n        bar_corner_radius: 3,\r\n        arrow_curve: 5,\r\n        padding: 18,\r\n\r\n        // Custom tooltip (using type assertion for custom property)\r\n        custom_popup_html: ((task: any) => {\r\n          const originalTask = task._original as GanttTask;\r\n          if (!originalTask) return \"\";\r\n\r\n          return `\r\n            <div class=\"gantt-tooltip\">\r\n              <h5>${originalTask.name}</h5>\r\n              ${originalTask.assignee ? `<p><strong>Ng∆∞·ªùi x·ª≠ l√Ω:</strong> ${originalTask.assignee.name}</p>` : \"\"}\r\n              <p><strong>B·∫Øt ƒë·∫ßu:</strong> ${format(originalTask.start, \"dd/MM/yyyy\", { locale: vi })}</p>\r\n              <p><strong>K·∫øt th√∫c:</strong> ${format(originalTask.end, \"dd/MM/yyyy\", { locale: vi })}</p>\r\n              <p><strong>Ti·∫øn ƒë·ªô:</strong> ${originalTask.progress}%</p>\r\n              <p><strong>Tr·∫°ng th√°i:</strong> ${formatStatus(originalTask.status)}</p>\r\n              <p><strong>ƒê·ªô ∆∞u ti√™n:</strong> ${formatPriority(originalTask.priority)}</p>\r\n            </div>\r\n          `;\r\n        }) as any,\r\n      } as any);\r\n    } catch (error) {\r\n      console.error(\"Error creating Gantt chart:\", error);\r\n    }\r\n\r\n    // Cleanup\r\n    return () => {\r\n      if (ganttInstance.current) {\r\n        ganttInstance.current = null;\r\n      }\r\n    };\r\n  }, [tasks, viewMode, onTaskClick, onDateChange]);\r\n\r\n  if (tasks.length === 0) {\r\n    return (\r\n      <div className=\"flex items-center justify-center bg-gray-50 rounded-lg border\" style={{ height }}>\r\n        <p className=\"text-gray-600\">Ch∆∞a c√≥ c√¥ng vi·ªác n√†o ƒë·ªÉ hi·ªÉn th·ªã</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"gantt-container\" style={{ height }}>\r\n      <div ref={ganttRef}></div>\r\n    </div>\r\n  );\r\n}\r\n\r\n// Helper functions for Vietnamese labels\r\nfunction formatStatus(status: string): string {\r\n  const statusMap: Record<string, string> = {\r\n    TODO: \"Ch∆∞a b·∫Øt ƒë·∫ßu\",\r\n    IN_PROGRESS: \"ƒêang l√†m\",\r\n    IN_REVIEW: \"ƒêang duy·ªát\",\r\n    BLOCKED: \"B·ªã ch·∫∑n\",\r\n    REWORK: \"L√†m l·∫°i\",\r\n    DONE: \"Ho√†n th√†nh\",\r\n  };\r\n  return statusMap[status] || status;\r\n}\r\n\r\nfunction formatPriority(priority: string): string {\r\n  const priorityMap: Record<string, string> = {\r\n    LOW: \"Th·∫•p\",\r\n    MEDIUM: \"Trung b√¨nh\",\r\n    HIGH: \"Cao\",\r\n    URGENT: \"Kh·∫©n c·∫•p\",\r\n  };\r\n  return priorityMap[priority] || priority;\r\n}\r\n\r\n// Gantt Chart with view mode controls\r\ninterface GanttChartWithControlsProps extends Omit<GanttChartProps, \"viewMode\"> {\r\n  defaultViewMode?: \"Day\" | \"Week\" | \"Month\";\r\n}\r\n\r\nexport function GanttChartWithControls({\r\n  tasks,\r\n  onTaskClick,\r\n  onDateChange,\r\n  defaultViewMode = \"Week\",\r\n  height = 500,\r\n}: GanttChartWithControlsProps) {\r\n  const [viewMode, setViewMode] = useState<\"Quarter Day\" | \"Half Day\" | \"Day\" | \"Week\" | \"Month\">(\r\n    defaultViewMode\r\n  );\r\n\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      {/* View mode controls */}\r\n      <div className=\"flex items-center justify-between\">\r\n        <div className=\"flex gap-2\">\r\n          <Button\r\n            variant={viewMode === \"Day\" ? \"default\" : \"outline\"}\r\n            size=\"sm\"\r\n            onClick={() => setViewMode(\"Day\")}\r\n          >\r\n            Ng√†y\r\n          </Button>\r\n          <Button\r\n            variant={viewMode === \"Week\" ? \"default\" : \"outline\"}\r\n            size=\"sm\"\r\n            onClick={() => setViewMode(\"Week\")}\r\n          >\r\n            Tu·∫ßn\r\n          </Button>\r\n          <Button\r\n            variant={viewMode === \"Month\" ? \"default\" : \"outline\"}\r\n            size=\"sm\"\r\n            onClick={() => setViewMode(\"Month\")}\r\n          >\r\n            Th√°ng\r\n          </Button>\r\n        </div>\r\n\r\n        <div className=\"text-sm text-gray-600\">\r\n          {tasks.length} c√¥ng vi·ªác\r\n        </div>\r\n      </div>\r\n\r\n      {/* Gantt chart */}\r\n      <GanttChart\r\n        tasks={tasks}\r\n        viewMode={viewMode}\r\n        onTaskClick={onTaskClick}\r\n        onDateChange={onDateChange}\r\n        height={height}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Admin\\Desktop\\tms-fix\\tms-real-main\\components\\dashboard\\kpi-card.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":20,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":20,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[563,566],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[563,566],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport React from \"react\";\r\nimport { ArrowUp, ArrowDown, Minus, type LucideIcon } from \"lucide-react\";\r\nimport * as Icons from \"lucide-react\";\r\nimport { cn } from \"@/lib/utils\";\r\n\r\nexport interface KPICardProps {\r\n  title: string;\r\n  value: string | number;\r\n  change?: number;\r\n  trend?: \"up\" | \"down\" | \"stable\";\r\n  icon: string;\r\n  color: string;\r\n  description?: string;\r\n  loading?: boolean;\r\n}\r\n\r\nexport function KPICard({ title, value, change, trend, icon, color, description, loading }: KPICardProps) {\r\n  const IconComponent = (Icons as any)[icon] as LucideIcon;\r\n  void color;\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"relative bg-white rounded-2xl border border-gray-200 shadow-sm p-6 overflow-hidden\">\r\n        {/* Shimmer animation */}\r\n        <div className=\"absolute inset-0 -translate-x-full animate-[shimmer_2s_infinite] bg-gradient-to-r from-transparent via-white/60 to-transparent\" />\r\n        \r\n        <div className=\"flex items-start justify-between mb-4\">\r\n          <div className=\"h-4 bg-gray-200 rounded w-24 animate-pulse\" />\r\n          <div className=\"h-12 w-12 bg-gray-200 rounded-full animate-pulse\" />\r\n        </div>\r\n        <div className=\"h-10 bg-gray-200 rounded w-28 mb-2 animate-pulse\" />\r\n        <div className=\"h-3 bg-gray-200 rounded w-20 animate-pulse\" />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"group relative bg-white rounded-2xl border-l-4 border-l-primary-500 shadow-primary-sm hover:shadow-primary-md transition-all hover:-translate-y-1 overflow-hidden\">\r\n      {/* Subtle gradient overlay on hover */}\r\n      <div className=\"absolute inset-0 bg-gradient-to-br from-primary-500/0 via-transparent to-accent-500/0 group-hover:from-primary-500/5 group-hover:to-accent-500/5 transition-all pointer-events-none\" />\r\n      \r\n      <div className=\"relative p-6\">\r\n        {/* Icon */}\r\n        <div className=\"flex items-start justify-between mb-4\">\r\n          <h3 className=\"text-sm font-semibold text-dark-600 uppercase tracking-wide\">{title}</h3>\r\n          {IconComponent && (\r\n            <div className=\"h-12 w-12 rounded-full bg-primary-100 flex items-center justify-center group-hover:scale-110 transition-transform\">\r\n              <IconComponent className=\"h-6 w-6 text-primary-600\" strokeWidth={2} />\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Value */}\r\n        <div className=\"mb-3\">\r\n          <div className=\"text-4xl font-bold text-gray-900 tracking-tight\">{value}</div>\r\n        </div>\r\n\r\n        {/* Change indicator */}\r\n        {change !== undefined && (\r\n          <div className=\"flex items-center gap-2\">\r\n            <div\r\n              className={cn(\r\n                \"flex items-center gap-1 px-2.5 py-1 rounded-full text-xs font-medium\",\r\n                trend === \"up\" && \"bg-green-100 text-green-700\",\r\n                trend === \"down\" && \"bg-red-100 text-red-700\",\r\n                trend === \"stable\" && \"bg-gray-100 text-gray-700\"\r\n              )}\r\n            >\r\n              {trend === \"up\" && <ArrowUp className=\"h-3 w-3\" strokeWidth={3} />}\r\n              {trend === \"down\" && <ArrowDown className=\"h-3 w-3\" strokeWidth={3} />}\r\n              {trend === \"stable\" && <Minus className=\"h-3 w-3\" strokeWidth={3} />}\r\n              <span>\r\n                {change > 0 && trend !== \"down\" ? \"+\" : \"\"}\r\n                {change}%\r\n              </span>\r\n            </div>\r\n            {description && <span className=\"text-xs text-gray-500\">{description}</span>}\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport interface KPICardsGridProps {\r\n  kpis: KPICardProps[];\r\n  loading?: boolean;\r\n}\r\n\r\nexport function KPICardsGrid({ kpis, loading }: KPICardsGridProps) {\r\n  if (loading) {\r\n    return (\r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4\">\r\n        {[...Array(5)].map((_, i) => (\r\n          <KPICard\r\n            key={i}\r\n            title=\"\"\r\n            value=\"\"\r\n            icon=\"Activity\"\r\n            color=\"blue\"\r\n            loading={true}\r\n          />\r\n        ))}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (kpis.length === 0) {\r\n    return (\r\n      <div className=\"bg-gray-50 rounded-lg border-2 border-dashed p-12 text-center\">\r\n        <p className=\"text-gray-600\">Kh√¥ng c√≥ d·ªØ li·ªáu trong kho·∫£ng th·ªùi gian n√†y</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4\">\r\n      {kpis.map((kpi) => (\r\n        <KPICard key={kpi.title} {...kpi} />\r\n      ))}\r\n    </div>\r\n  );\r\n}\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Admin\\Desktop\\tms-fix\\tms-real-main\\components\\dashboard\\predictions-panel.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":190,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":190,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6774,6777],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6774,6777],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport React from \"react\";\r\nimport {\r\n  TrendingUp,\r\n  AlertTriangle,\r\n  Calendar,\r\n  BarChart3,\r\n} from \"lucide-react\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Progress } from \"@/components/ui/progress\";\r\nimport {\r\n  BarChart,\r\n  Bar,\r\n  XAxis,\r\n  YAxis,\r\n  CartesianGrid,\r\n  Tooltip,\r\n  ResponsiveContainer,\r\n} from \"recharts\";\r\nimport type {\r\n  ForecastData,\r\n  BurnoutRisk,\r\n  CapacityShortfall,\r\n} from \"@/lib/services/prediction-service\";\r\nimport { format } from \"date-fns\";\r\nimport { vi } from \"date-fns/locale\";\r\n\r\ninterface Props {\r\n  forecast: ForecastData | null;\r\n  burnoutRisks: BurnoutRisk[];\r\n  capacityShortfalls: CapacityShortfall[];\r\n  loading?: boolean;\r\n}\r\n\r\nexport function PredictionsPanel({ \r\n  forecast, \r\n  burnoutRisks, \r\n  capacityShortfalls,\r\n  loading \r\n}: Props) {\r\n  if (loading) {\r\n    return (\r\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\r\n        {[...Array(3)].map((_, i) => (\r\n          <div key={i} className=\"h-64 bg-gray-100 rounded animate-pulse\"></div>\r\n        ))}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\r\n      {/* Card 1: Forecast */}\r\n      <div className=\"border rounded-lg p-6 bg-gradient-to-br from-blue-50 to-white\">\r\n        <div className=\"flex items-center gap-2 mb-4\">\r\n          <TrendingUp className=\"h-5 w-5 text-blue-600\" />\r\n          <h3 className=\"font-semibold text-gray-900\">D·ª± b√°o ho√†n th√†nh</h3>\r\n        </div>\r\n\r\n        {forecast ? (\r\n          <div className=\"space-y-4\">\r\n            <div>\r\n              <p className=\"text-3xl font-bold text-gray-900\">\r\n                {forecast.backlogCount}\r\n              </p>\r\n              <p className=\"text-sm text-gray-600\">y√™u c·∫ßu c√≤n l·∫°i</p>\r\n            </div>\r\n\r\n            <div className=\"space-y-2\">\r\n              <div className=\"flex items-center justify-between text-sm\">\r\n                <span className=\"text-gray-600\">D·ª± ki·∫øn ho√†n th√†nh</span>\r\n                <Badge\r\n                  variant=\"outline\"\r\n                  className={\r\n                    forecast.confidence === 'high' ? 'bg-green-50 text-green-700' :\r\n                    forecast.confidence === 'medium' ? 'bg-yellow-50 text-yellow-700' :\r\n                    'bg-gray-50 text-gray-700'\r\n                  }\r\n                >\r\n                  {forecast.confidence === 'high' ? 'ƒê·ªô tin c·∫≠y cao' :\r\n                   forecast.confidence === 'medium' ? 'ƒê·ªô tin c·∫≠y TB' :\r\n                   'ƒê·ªô tin c·∫≠y th·∫•p'}\r\n                </Badge>\r\n              </div>\r\n              \r\n              <div className=\"flex items-center gap-2 text-gray-900\">\r\n                <Calendar className=\"h-4 w-4 text-blue-600\" />\r\n                <span className=\"font-medium\">\r\n                  {format(forecast.forecastDate, 'dd MMMM yyyy', { locale: vi })}\r\n                </span>\r\n              </div>\r\n\r\n              <p className=\"text-xs text-gray-600\">\r\n                ({forecast.estimatedDays} ng√†y, nƒÉng su·∫•t TB: {forecast.avgThroughput}/ng√†y)\r\n              </p>\r\n            </div>\r\n\r\n            <Progress \r\n              value={Math.min(100, (forecast.backlogCount / (forecast.backlogCount + 10)) * 100)} \r\n              className=\"h-2\"\r\n            />\r\n          </div>\r\n        ) : (\r\n          <p className=\"text-sm text-gray-500\">Ch∆∞a c√≥ d·ªØ li·ªáu d·ª± b√°o</p>\r\n        )}\r\n      </div>\r\n\r\n      {/* Card 2: Burnout Risks */}\r\n      <div className=\"border rounded-lg p-6 bg-gradient-to-br from-orange-50 to-white\">\r\n        <div className=\"flex items-center gap-2 mb-4\">\r\n          <AlertTriangle className=\"h-5 w-5 text-orange-600\" />\r\n          <h3 className=\"font-semibold text-gray-900\">C·∫£nh b√°o burnout</h3>\r\n        </div>\r\n\r\n        {burnoutRisks.length > 0 ? (\r\n          <div className=\"space-y-3 max-h-[300px] overflow-y-auto\">\r\n            {burnoutRisks.slice(0, 3).map((risk) => (\r\n              <div \r\n                key={risk.userId}\r\n                className={`border rounded-lg p-3 ${\r\n                  risk.severity === 'high' ? 'bg-red-50 border-red-200' :\r\n                  risk.severity === 'medium' ? 'bg-orange-50 border-orange-200' :\r\n                  'bg-yellow-50 border-yellow-200'\r\n                }`}\r\n              >\r\n                <div className=\"flex items-center justify-between mb-2\">\r\n                  <p className=\"font-medium text-sm text-gray-900\">\r\n                    {risk.userName}\r\n                  </p>\r\n                  <Badge \r\n                    variant=\"outline\"\r\n                    className={\r\n                      risk.severity === 'high' ? 'bg-red-100 text-red-700' :\r\n                      risk.severity === 'medium' ? 'bg-orange-100 text-orange-700' :\r\n                      'bg-yellow-100 text-yellow-700'\r\n                    }\r\n                  >\r\n                    {risk.riskScore}\r\n                  </Badge>\r\n                </div>\r\n\r\n                <div className=\"space-y-1 mb-2\">\r\n                  {risk.factors.slice(0, 2).map((factor, idx) => (\r\n                    <p key={idx} className=\"text-xs text-gray-600\">\r\n                      ‚Ä¢ {factor}\r\n                    </p>\r\n                  ))}\r\n                </div>\r\n\r\n                <p className=\"text-xs text-gray-700 italic\">\r\n                  üí° {risk.recommendation}\r\n                </p>\r\n              </div>\r\n            ))}\r\n\r\n            {burnoutRisks.length > 3 && (\r\n              <p className=\"text-xs text-center text-gray-500\">\r\n                +{burnoutRisks.length - 3} ng∆∞·ªùi kh√°c\r\n              </p>\r\n            )}\r\n          </div>\r\n        ) : (\r\n          <div className=\"text-center py-8\">\r\n            <p className=\"text-green-600 font-medium mb-1\">‚úÖ Kh√¥ng ph√°t hi·ªán r·ªßi ro</p>\r\n            <p className=\"text-xs text-gray-600\">Workload ƒëang ·ªïn ƒë·ªãnh</p>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Card 3: Capacity Planning */}\r\n      <div className=\"border rounded-lg p-6 bg-gradient-to-br from-purple-50 to-white\">\r\n        <div className=\"flex items-center gap-2 mb-4\">\r\n          <BarChart3 className=\"h-5 w-5 text-purple-600\" />\r\n          <h3 className=\"font-semibold text-gray-900\">K·∫ø ho·∫°ch nƒÉng l·ª±c</h3>\r\n        </div>\r\n\r\n        {capacityShortfalls.length > 0 ? (\r\n          <div className=\"space-y-4\">\r\n            <ResponsiveContainer width=\"100%\" height={200}>\r\n              <BarChart data={capacityShortfalls}>\r\n                <CartesianGrid strokeDasharray=\"3 3\" stroke=\"#e5e7eb\" />\r\n                <XAxis \r\n                  dataKey=\"week\" \r\n                  tick={{ fontSize: 10 }}\r\n                />\r\n                <YAxis tick={{ fontSize: 10 }} />\r\n                <Tooltip \r\n                  contentStyle={{ fontSize: 12 }}\r\n                  formatter={(value: any) => [`${value} tasks`, '']}\r\n                />\r\n                <Bar dataKey=\"capacity\" fill=\"#10b981\" name=\"Capacity\" />\r\n                <Bar dataKey=\"demand\" fill=\"#3b82f6\" name=\"Demand\" />\r\n              </BarChart>\r\n            </ResponsiveContainer>\r\n\r\n            {/* Summary */}\r\n            <div className=\"space-y-2\">\r\n              {capacityShortfalls\r\n                .filter(s => s.shortfall > 0)\r\n                .slice(0, 2)\r\n                .map((shortfall) => (\r\n                  <div \r\n                    key={shortfall.week}\r\n                    className={`text-xs p-2 rounded ${\r\n                      shortfall.severity === 'high' ? 'bg-red-50 text-red-700' :\r\n                      shortfall.severity === 'medium' ? 'bg-orange-50 text-orange-700' :\r\n                      'bg-yellow-50 text-yellow-700'\r\n                    }`}\r\n                  >\r\n                    ‚ö†Ô∏è {shortfall.week}: Thi·∫øu {shortfall.shortfall} slot\r\n                  </div>\r\n                ))}\r\n              \r\n              {capacityShortfalls.every(s => s.shortfall === 0) && (\r\n                <div className=\"text-center py-2\">\r\n                  <p className=\"text-xs text-green-600\">‚úÖ NƒÉng l·ª±c ƒë·ªß cho 4 tu·∫ßn t·ªõi</p>\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        ) : (\r\n          <p className=\"text-sm text-gray-500\">Ch∆∞a c√≥ d·ªØ li·ªáu d·ª± b√°o</p>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Admin\\Desktop\\tms-fix\\tms-real-main\\components\\dashboard\\quality-metrics.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":91,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":91,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3406,3409],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3406,3409],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":202,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":202,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8286,8289],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8286,8289],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":202,"column":69,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":202,"endColumn":72,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8315,8318],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8315,8318],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport React from \"react\";\r\nimport {\r\n  LineChart,\r\n  Line,\r\n  BarChart,\r\n  Bar,\r\n  XAxis,\r\n  YAxis,\r\n  CartesianGrid,\r\n  Tooltip,\r\n  ResponsiveContainer,\r\n  ReferenceLine,\r\n  Cell,\r\n} from \"recharts\";\r\nimport { CheckCircle, AlertCircle, MessageCircle } from \"lucide-react\";\r\nimport type { ReworkData, ApprovalData, ClarificationData } from \"@/lib/services/quality-service\";\r\n\r\ninterface Props {\r\n  reworkData: ReworkData;\r\n  approvalData: ApprovalData;\r\n  clarificationData: ClarificationData;\r\n  loading?: boolean;\r\n}\r\n\r\nexport function QualityMetrics({ reworkData, approvalData, clarificationData, loading }: Props) {\r\n  if (loading) {\r\n    return (\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\r\n        {[...Array(3)].map((_, i) => (\r\n          <div key={i} className=\"bg-gray-50 rounded-lg p-6 animate-pulse\">\r\n            <div className=\"h-6 bg-gray-200 rounded w-32 mb-4\"></div>\r\n            <div className=\"h-[200px] bg-gray-200 rounded\"></div>\r\n          </div>\r\n        ))}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const medals = ['ü•á', 'ü•à', 'ü•â'];\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Quality Insights */}\r\n      <div className=\"bg-gradient-to-r from-green-50 to-blue-50 border border-green-200 rounded-lg p-4\">\r\n        <h3 className=\"text-sm font-semibold text-gray-900 mb-2 flex items-center gap-2\">\r\n          <CheckCircle className=\"h-4 w-4 text-green-600\" />\r\n          Th√¥ng tin ch·∫•t l∆∞·ª£ng\r\n        </h3>\r\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm\">\r\n          <div>\r\n            <p className=\"text-gray-600\">T·ª∑ l·ªá l√†m l·∫°i:</p>\r\n            <p className={`text-lg font-bold ${reworkData.overall <= 10 ? 'text-green-600' : 'text-red-600'}`}>\r\n              {reworkData.overall.toFixed(1)}%\r\n            </p>\r\n          </div>\r\n          <div>\r\n            <p className=\"text-gray-600\">Duy·ªát l·∫ßn ƒë·∫ßu:</p>\r\n            <p className={`text-lg font-bold ${approvalData.overall >= 80 ? 'text-green-600' : 'text-amber-600'}`}>\r\n              {approvalData.overall.toFixed(1)}%\r\n            </p>\r\n          </div>\r\n          <div>\r\n            <p className=\"text-gray-600\">C·∫ßn l√†m r√µ:</p>\r\n            <p className={`text-lg font-bold ${clarificationData.overall <= 15 ? 'text-green-600' : 'text-amber-600'}`}>\r\n              {clarificationData.overall.toFixed(1)}%\r\n            </p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Charts Grid */}\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\r\n        {/* Rework Rate Trend */}\r\n        <div className=\"bg-white rounded-lg border p-6\">\r\n          <div className=\"flex items-center gap-2 mb-4\">\r\n            <AlertCircle className=\"h-5 w-5 text-red-500\" />\r\n            <h3 className=\"text-base font-semibold text-gray-900\">Xu h∆∞·ªõng l√†m l·∫°i</h3>\r\n          </div>\r\n          \r\n          {reworkData.trend.length > 0 ? (\r\n            <>\r\n              <ResponsiveContainer width=\"100%\" height={200}>\r\n                <LineChart data={reworkData.trend} margin={{ top: 10, right: 10, left: 0, bottom: 5 }}>\r\n                  <CartesianGrid strokeDasharray=\"3 3\" stroke=\"#e5e7eb\" />\r\n                  <XAxis dataKey=\"week\" tick={{ fontSize: 11 }} />\r\n                  <YAxis domain={[0, 20]} tick={{ fontSize: 11 }} />\r\n                  <Tooltip \r\n                    contentStyle={{ fontSize: 12 }}\r\n                    formatter={(value: any) => `${value}%`}\r\n                    labelFormatter={(label) => `${label}`}\r\n                  />\r\n                  <ReferenceLine \r\n                    y={10} \r\n                    stroke=\"#ef4444\" \r\n                    strokeDasharray=\"5 5\"\r\n                    label={{ value: 'M·ª•c ti√™u 10%', fontSize: 10, fill: '#6b7280' }}\r\n                  />\r\n                  <Line \r\n                    type=\"monotone\"\r\n                    dataKey=\"rate\" \r\n                    stroke=\"#ef4444\"\r\n                    strokeWidth={2}\r\n                    dot={{ r: 4 }}\r\n                  />\r\n                </LineChart>\r\n              </ResponsiveContainer>\r\n              <div className=\"mt-3 text-xs text-gray-600\">\r\n                {reworkData.trend.length >= 2 && (\r\n                  <p>\r\n                    {reworkData.trend[reworkData.trend.length - 1].rate < reworkData.trend[reworkData.trend.length - 2].rate\r\n                      ? 'üìà ƒêang c·∫£i thi·ªán'\r\n                      : 'üìâ C·∫ßn ch√∫ √Ω'}\r\n                  </p>\r\n                )}\r\n              </div>\r\n            </>\r\n          ) : (\r\n            <div className=\"h-[200px] flex items-center justify-center bg-gray-50 rounded\">\r\n              <p className=\"text-sm text-gray-600\">Ch∆∞a c√≥ d·ªØ li·ªáu</p>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* First-Time Approval Leaderboard */}\r\n        <div className=\"bg-white rounded-lg border p-6\">\r\n          <div className=\"flex items-center gap-2 mb-4\">\r\n            <CheckCircle className=\"h-5 w-5 text-green-500\" />\r\n            <h3 className=\"text-base font-semibold text-gray-900\">B·∫£ng x·∫øp h·∫°ng duy·ªát l·∫ßn ƒë·∫ßu</h3>\r\n          </div>\r\n          \r\n          {approvalData.byAssignee.length > 0 ? (\r\n            <div className=\"space-y-2\">\r\n              {approvalData.byAssignee.slice(0, 10).map((assignee, index) => (\r\n                <div key={assignee.assigneeId} className=\"flex items-center gap-2\">\r\n                  <span className=\"text-lg w-6\">\r\n                    {index < 3 ? medals[index] : `${index + 1}.`}\r\n                  </span>\r\n                  <div className=\"flex-1 min-w-0\">\r\n                    <div className=\"flex items-center justify-between text-xs mb-1\">\r\n                      <span className=\"font-medium text-gray-900 truncate\">\r\n                        {assignee.name}\r\n                      </span>\r\n                      <span className={`font-bold ${\r\n                        assignee.rate >= 90 ? 'text-green-600' :\r\n                        assignee.rate >= 70 ? 'text-blue-600' :\r\n                        'text-amber-600'\r\n                      }`}>\r\n                        {assignee.rate.toFixed(0)}%\r\n                      </span>\r\n                    </div>\r\n                    <div className=\"w-full bg-gray-200 rounded-full h-2\">\r\n                      <div \r\n                        className={`h-2 rounded-full ${\r\n                          assignee.rate >= 90 ? 'bg-green-500' :\r\n                          assignee.rate >= 70 ? 'bg-blue-500' :\r\n                          'bg-amber-500'\r\n                        }`}\r\n                        style={{ width: `${assignee.rate}%` }}\r\n                      />\r\n                    </div>\r\n                    <p className=\"text-xs text-gray-500 mt-0.5\">\r\n                      {assignee.approvedFirstTime}/{assignee.totalTasks} tasks\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          ) : (\r\n            <div className=\"h-[200px] flex items-center justify-center bg-gray-50 rounded\">\r\n              <p className=\"text-sm text-gray-600\">Ch∆∞a c√≥ d·ªØ li·ªáu</p>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Clarification Analysis */}\r\n        <div className=\"bg-white rounded-lg border p-6\">\r\n          <div className=\"flex items-center gap-2 mb-4\">\r\n            <MessageCircle className=\"h-5 w-5 text-amber-500\" />\r\n            <h3 className=\"text-base font-semibold text-gray-900\">Ph√¢n t√≠ch l√†m r√µ</h3>\r\n          </div>\r\n          \r\n          {clarificationData.byRequester.length > 0 ? (\r\n            <>\r\n              <ResponsiveContainer width=\"100%\" height={200}>\r\n                <BarChart \r\n                  data={clarificationData.byRequester.slice(0, 5)} \r\n                  margin={{ top: 10, right: 10, left: 0, bottom: 40 }}\r\n                  layout=\"vertical\"\r\n                >\r\n                  <CartesianGrid strokeDasharray=\"3 3\" stroke=\"#e5e7eb\" />\r\n                  <XAxis type=\"number\" tick={{ fontSize: 11 }} />\r\n                  <YAxis \r\n                    type=\"category\" \r\n                    dataKey=\"name\" \r\n                    tick={{ fontSize: 11 }}\r\n                    width={80}\r\n                  />\r\n                  <Tooltip \r\n                    contentStyle={{ fontSize: 12 }}\r\n                    formatter={(value: any, _name?: string, props?: any) => [\r\n                      `${value}% (${props.payload.count}/${props.payload.totalRequests})`,\r\n                      'C·∫ßn l√†m r√µ'\r\n                    ]}\r\n                  />\r\n                  <Bar dataKey=\"rate\" radius={[0, 4, 4, 0]}>\r\n                    {clarificationData.byRequester.map((entry, index) => (\r\n                      <Cell \r\n                        key={`cell-${index}`} \r\n                        fill={entry.rate > 30 ? '#f97316' : '#f59e0b'} \r\n                      />\r\n                    ))}\r\n                  </Bar>\r\n                </BarChart>\r\n              </ResponsiveContainer>\r\n              <div className=\"mt-3 text-xs text-gray-600\">\r\n                <p>T·ªïng: {clarificationData.overall.toFixed(1)}% y√™u c·∫ßu c·∫ßn l√†m r√µ</p>\r\n              </div>\r\n            </>\r\n          ) : (\r\n            <div className=\"h-[200px] flex items-center justify-center bg-gray-50 rounded\">\r\n              <p className=\"text-sm text-gray-600\">Ch∆∞a c√≥ d·ªØ li·ªáu</p>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Admin\\Desktop\\tms-fix\\tms-real-main\\components\\dashboard\\resolution-funnel.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Admin\\Desktop\\tms-fix\\tms-real-main\\components\\dashboard\\response-time-chart.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Admin\\Desktop\\tms-fix\\tms-real-main\\components\\dashboard\\sla-compliance-chart.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Admin\\Desktop\\tms-fix\\tms-real-main\\components\\dashboard\\sla-trend-chart.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Admin\\Desktop\\tms-fix\\tms-real-main\\components\\dashboard\\sla-violations-table.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Admin\\Desktop\\tms-fix\\tms-real-main\\components\\dashboard\\tag-cloud.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Admin\\Desktop\\tms-fix\\tms-real-main\\components\\dashboard\\team-leaderboard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Admin\\Desktop\\tms-fix\\tms-real-main\\components\\dashboard\\team-radar-chart.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Admin\\Desktop\\tms-fix\\tms-real-main\\components\\dashboard\\workload-distribution-chart.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":52,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":52,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1424,1427],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1424,1427],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport React from \"react\";\r\nimport {\r\n  PieChart,\r\n  Pie,\r\n  Cell,\r\n  ResponsiveContainer,\r\n  Tooltip,\r\n  Legend,\r\n} from \"recharts\";\r\nimport type { PieLabelRenderProps } from \"recharts\";\r\nimport type { WorkloadDistribution } from \"@/lib/services/chart-service\";\r\nimport { TooltipCard } from \"@/components/charts/tooltip-card\";\r\nimport { TASK_STATUS_COLORS, TASK_STATUS_LABELS } from \"@/lib/constants/dashboard\";\r\n\r\ninterface Props {\r\n  data: WorkloadDistribution[];\r\n  loading?: boolean;\r\n}\r\n\r\ntype WorkloadTooltipPayloadItem = {\r\n  name: string;\r\n  payload: { count: number; percentage: number };\r\n};\r\n\r\nfunction WorkloadDistributionTooltip({\r\n  active,\r\n  payload,\r\n}: {\r\n  active?: boolean;\r\n  payload?: WorkloadTooltipPayloadItem[];\r\n}) {\r\n  if (!active || !payload || payload.length === 0) return null;\r\n\r\n  const item = payload[0];\r\n\r\n  return (\r\n    <TooltipCard className=\"rounded-xl border-gray-200\">\r\n      <p className=\"text-sm font-medium text-dark-900 mb-1\">{item?.name}</p>\r\n      <p className=\"text-sm text-gray-700\">\r\n        <span className=\"font-medium\">S·ªë l∆∞·ª£ng:</span> {item?.payload?.count}\r\n      </p>\r\n      <p className=\"text-sm text-primary-600 font-semibold\">\r\n        <span className=\"font-medium\">T·ª∑ l·ªá:</span> {item?.payload?.percentage}%\r\n      </p>\r\n    </TooltipCard>\r\n  );\r\n}\r\n\r\nfunction renderPieLabel(props: PieLabelRenderProps) {\r\n  const percentage = (props.payload as any)?.percentage;\r\n  return `${percentage ?? 0}%`;\r\n}\r\n\r\nexport function WorkloadDistributionChart({ data, loading }: Props) {\r\n  if (loading) {\r\n    return (\r\n      <div className=\"bg-white rounded-lg border p-6\">\r\n        <div className=\"space-y-3\">\r\n          <div className=\"h-6 bg-gray-200 rounded w-64 animate-pulse\"></div>\r\n          <div className=\"h-[300px] bg-gray-50 rounded animate-pulse mt-4\"></div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (data.length === 0) {\r\n    return (\r\n      <div className=\"bg-white rounded-lg border p-6\">\r\n        <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">\r\n          Ph√¢n b·ªë kh·ªëi l∆∞·ª£ng c√¥ng vi·ªác\r\n        </h3>\r\n        <div className=\"h-[300px] flex items-center justify-center bg-gray-50 rounded\">\r\n          <div className=\"text-center\">\r\n            <p className=\"text-gray-600 mb-2\">Kh√¥ng c√≥ c√¥ng vi·ªác ƒëang th·ª±c hi·ªán</p>\r\n            <p className=\"text-sm text-gray-500\">D·ªØ li·ªáu s·∫Ω hi·ªÉn th·ªã khi c√≥ c√¥ng vi·ªác ƒë∆∞·ª£c t·∫°o</p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const totalTasks = data.reduce((sum, item) => sum + item.count, 0);\r\n\r\n  // Enhance data with labels\r\n  const chartData = data.map(item => ({\r\n    ...item,\r\n    name: TASK_STATUS_LABELS[item.status] || item.status,\r\n    fill: TASK_STATUS_COLORS[item.status] || '#6b7280',\r\n  }));\r\n\r\n  return (\r\n    <div className=\"bg-white rounded-2xl border border-gray-200 p-6\">\r\n      {/* Header */}\r\n      <div className=\"mb-4\">\r\n        <h3 className=\"text-lg font-semibold text-dark-900\">Ph√¢n b·ªë kh·ªëi l∆∞·ª£ng c√¥ng vi·ªác</h3>\r\n        <p className=\"text-sm text-gray-600\">T·ªïng: {totalTasks} c√¥ng vi·ªác ƒëang th·ª±c hi·ªán</p>\r\n      </div>\r\n\r\n      {/* Chart */}\r\n      <ResponsiveContainer width=\"100%\" height={300}>\r\n        <PieChart>\r\n          <Pie\r\n            data={chartData}\r\n            cx=\"50%\"\r\n            cy=\"50%\"\r\n            labelLine={false}\r\n            label={renderPieLabel}\r\n            outerRadius={90}\r\n            innerRadius={50}\r\n            dataKey=\"count\"\r\n            paddingAngle={2}\r\n          >\r\n            {chartData.map((entry, index) => (\r\n              <Cell key={`cell-${index}`} fill={entry.fill} />\r\n            ))}\r\n          </Pie>\r\n          <Tooltip content={<WorkloadDistributionTooltip />} />\r\n          <Legend \r\n            layout=\"horizontal\"\r\n            verticalAlign=\"bottom\"\r\n            align=\"center\"\r\n            wrapperStyle={{ fontSize: 12, paddingTop: 20 }}\r\n          />\r\n        </PieChart>\r\n      </ResponsiveContainer>\r\n\r\n      {/* Center label (total) */}\r\n      <div className=\"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 text-center pointer-events-none\">\r\n        {/* This would need CSS positioning, skipping for simplicity */}\r\n      </div>\r\n\r\n      {/* Footer Summary */}\r\n      <div className=\"mt-4 pt-4 border-t grid grid-cols-2 gap-3 text-sm\">\r\n        {chartData.map((item) => (\r\n          <div key={item.status} className=\"flex items-center gap-2\">\r\n            <div \r\n              className=\"w-3 h-3 rounded-full\" \r\n              style={{ backgroundColor: item.fill }}\r\n            />\r\n            <span className=\"text-gray-700\">\r\n              {item.name}: <span className=\"font-medium\">{item.count}</span>\r\n            </span>\r\n          </div>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\Admin\\Desktop\\tms-fix\\tms-real-main\\components\\dashboard\\workload-heatmap.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]