# ============================================
# TMS 2025 - Environment Variables Template
# ============================================
# Copy this file to .env.local and fill in your values
# cp env.example .env.local

# ============================================
# Database
# ============================================
# PostgreSQL connection string
# Format: postgresql://USER:PASSWORD@HOST:PORT/DATABASE?sslmode=require
DATABASE_URL="postgresql://tmsuser:tmspassword@localhost:5432/tms2025?sslmode=require"
DB_SSL_REQUIRED="true"

# ============================================
# NextAuth / Authentication
# ============================================
# Generate with: openssl rand -base64 32
# Or use: node -e "console.log(require('crypto').randomBytes(32).toString('base64'))"
NEXTAUTH_SECRET="your-secret-key-here-generate-with-openssl-rand-base64-32"
AUTH_SECRET="your-secret-key-here-generate-with-openssl-rand-base64-32"

# Session settings
AUTH_SESSION_MAX_AGE_MINUTES="30"
AUTH_SESSION_UPDATE_AGE_MINUTES="5"

# Brute-force protection
AUTH_LOCKOUT_THRESHOLD="5"
AUTH_LOCKOUT_MINUTES="15"

# 2FA issuer name (shown in authenticator apps)
APP_2FA_ISSUER="TMS"

# ============================================
# Security - Encryption Keys (REQUIRED in production)
# ============================================
# PII Encryption Key - encrypts phone numbers, telegram usernames
# MUST be exactly 32 bytes, base64-encoded
# Generate with: openssl rand -base64 32
# WARNING: Without this key, sensitive data is stored UNENCRYPTED!
PII_ENCRYPTION_KEY="your-32-byte-base64-key-here"

# App URL (for authentication callbacks)
# Local: http://localhost:3000
# Production: https://your-domain.com
NEXTAUTH_URL="http://localhost:3000"
NEXT_PUBLIC_APP_URL="http://localhost:3000"

# ============================================
# Server Configuration
# ============================================
# Port for Next.js server (default: 3000)
PORT=3000

# Node environment
NODE_ENV="development"

# ============================================
# Telegram Bot (Optional)
# ============================================
# Get token from @BotFather on Telegram
TELEGRAM_BOT_TOKEN=""
TELEGRAM_BOT_USERNAME=""

# Webhook URL (your server URL + /api/telegram/webhook)
TELEGRAM_WEBHOOK_URL=""

# Webhook Secret - REQUIRED for production security
# This secret is sent by Telegram in x-telegram-bot-api-secret-token header
# Set when registering webhook with: setWebhook?url=...&secret_token=YOUR_SECRET
# Generate with: openssl rand -hex 32
TELEGRAM_WEBHOOK_SECRET=""

# ============================================
# Uploadthing (File Upload Service)
# ============================================
# Get your keys from: https://uploadthing.com/dashboard
UPLOADTHING_SECRET=""
UPLOADTHING_APP_ID=""

# ============================================
# VirusTotal (File Scanning Service)
# ============================================
# Get free API key from: https://www.virustotal.com/gui/join-us
# Free tier: 500 requests/day
VIRUSTOTAL_API_KEY=""

# ============================================
# Sentry (Error Tracking - Optional)
# ============================================
# Get DSN from: https://sentry.io/
NEXT_PUBLIC_SENTRY_DSN=""
SENTRY_ORG=""
SENTRY_PROJECT=""
SENTRY_AUTH_TOKEN=""
ENABLE_SENTRY="false"

# ============================================
# Cron Jobs (Server-side scheduled tasks)
# ============================================
# Secret for protecting cron endpoints from unauthorized access
# REQUIRED in production - endpoints will reject requests without valid token
# Used as Bearer token: Authorization: Bearer <CRON_SECRET>
# Generate with: openssl rand -base64 32
CRON_SECRET="your-cron-secret-here"

# ============================================
# Security - Advanced Configuration
# ============================================
# Password Policy
PASSWORD_MIN_LENGTH="8"
PASSWORD_EXPIRATION_DAYS="90"

# Geo-blocking (comma-separated ISO country codes)
# Example: "CN,RU,KP" to block China, Russia, North Korea
BLOCKED_COUNTRIES=""

# Rate Limiting - Trusted sources (bypass rate limits)
# Comma-separated IP addresses
RATE_LIMIT_TRUSTED_IPS=""
# Comma-separated API keys
RATE_LIMIT_TRUSTED_KEYS=""

# SIEM Integration (Security Information and Event Management)
# Endpoint to send security events for monitoring
SIEM_ENDPOINT=""

# Security.txt contact email (RFC 9116)
SECURITY_CONTACT_EMAIL="security@example.com"

# ============================================
# Docker (if using Docker Compose)
# ============================================
# These are usually set in docker-compose.yml
# POSTGRES_USER=tmsuser
# POSTGRES_PASSWORD=tmspassword
# POSTGRES_DB=tms2025

